{"ast":null,"code":"/*! codem-isoboxer v0.3.6 https://github.com/madebyhiro/codem-isoboxer/blob/master/LICENSE.txt */\nvar ISOBoxer = {};\n\nISOBoxer.parseBuffer = function (arrayBuffer) {\n  return new ISOFile(arrayBuffer).parse();\n};\n\nISOBoxer.addBoxProcessor = function (type, parser) {\n  if (typeof type !== 'string' || typeof parser !== 'function') {\n    return;\n  }\n\n  ISOBox.prototype._boxProcessors[type] = parser;\n};\n\nISOBoxer.createFile = function () {\n  return new ISOFile();\n}; // See ISOBoxer.append() for 'pos' parameter syntax\n\n\nISOBoxer.createBox = function (type, parent, pos) {\n  var newBox = ISOBox.create(type);\n\n  if (parent) {\n    parent.append(newBox, pos);\n  }\n\n  return newBox;\n}; // See ISOBoxer.append() for 'pos' parameter syntax\n\n\nISOBoxer.createFullBox = function (type, parent, pos) {\n  var newBox = ISOBoxer.createBox(type, parent, pos);\n  newBox.version = 0;\n  newBox.flags = 0;\n  return newBox;\n};\n\nISOBoxer.Utils = {};\n\nISOBoxer.Utils.dataViewToString = function (dataView, encoding) {\n  var impliedEncoding = encoding || 'utf-8';\n\n  if (typeof TextDecoder !== 'undefined') {\n    return new TextDecoder(impliedEncoding).decode(dataView);\n  }\n\n  var a = [];\n  var i = 0;\n\n  if (impliedEncoding === 'utf-8') {\n    /* The following algorithm is essentially a rewrite of the UTF8.decode at\n    http://bannister.us/weblog/2007/simple-base64-encodedecode-javascript/\n    */\n    while (i < dataView.byteLength) {\n      var c = dataView.getUint8(i++);\n\n      if (c < 0x80) {// 1-byte character (7 bits)\n      } else if (c < 0xe0) {\n        // 2-byte character (11 bits)\n        c = (c & 0x1f) << 6;\n        c |= dataView.getUint8(i++) & 0x3f;\n      } else if (c < 0xf0) {\n        // 3-byte character (16 bits)\n        c = (c & 0xf) << 12;\n        c |= (dataView.getUint8(i++) & 0x3f) << 6;\n        c |= dataView.getUint8(i++) & 0x3f;\n      } else {\n        // 4-byte character (21 bits)\n        c = (c & 0x7) << 18;\n        c |= (dataView.getUint8(i++) & 0x3f) << 12;\n        c |= (dataView.getUint8(i++) & 0x3f) << 6;\n        c |= dataView.getUint8(i++) & 0x3f;\n      }\n\n      a.push(String.fromCharCode(c));\n    }\n  } else {\n    // Just map byte-by-byte (probably wrong)\n    while (i < dataView.byteLength) {\n      a.push(String.fromCharCode(dataView.getUint8(i++)));\n    }\n  }\n\n  return a.join('');\n};\n\nISOBoxer.Utils.utf8ToByteArray = function (string) {\n  // Only UTF-8 encoding is supported by TextEncoder\n  var u, i;\n\n  if (typeof TextEncoder !== 'undefined') {\n    u = new TextEncoder().encode(string);\n  } else {\n    u = [];\n\n    for (i = 0; i < string.length; ++i) {\n      var c = string.charCodeAt(i);\n\n      if (c < 0x80) {\n        u.push(c);\n      } else if (c < 0x800) {\n        u.push(0xC0 | c >> 6);\n        u.push(0x80 | 63 & c);\n      } else if (c < 0x10000) {\n        u.push(0xE0 | c >> 12);\n        u.push(0x80 | 63 & c >> 6);\n        u.push(0x80 | 63 & c);\n      } else {\n        u.push(0xF0 | c >> 18);\n        u.push(0x80 | 63 & c >> 12);\n        u.push(0x80 | 63 & c >> 6);\n        u.push(0x80 | 63 & c);\n      }\n    }\n  }\n\n  return u;\n}; // Method to append a box in the list of child boxes\n// The 'pos' parameter can be either:\n//   - (number) a position index at which to insert the new box\n//   - (string) the type of the box after which to insert the new box\n//   - (object) the box after which to insert the new box\n\n\nISOBoxer.Utils.appendBox = function (parent, box, pos) {\n  box._offset = parent._cursor.offset;\n  box._root = parent._root ? parent._root : parent;\n  box._raw = parent._raw;\n  box._parent = parent;\n\n  if (pos === -1) {\n    // The new box is a sub-box of the parent but not added in boxes array,\n    // for example when the new box is set as an entry (see dref and stsd for example)\n    return;\n  }\n\n  if (pos === undefined || pos === null) {\n    parent.boxes.push(box);\n    return;\n  }\n\n  var index = -1,\n      type;\n\n  if (typeof pos === \"number\") {\n    index = pos;\n  } else {\n    if (typeof pos === \"string\") {\n      type = pos;\n    } else if (typeof pos === \"object\" && pos.type) {\n      type = pos.type;\n    } else {\n      parent.boxes.push(box);\n      return;\n    }\n\n    for (var i = 0; i < parent.boxes.length; i++) {\n      if (type === parent.boxes[i].type) {\n        index = i + 1;\n        break;\n      }\n    }\n  }\n\n  parent.boxes.splice(index, 0, box);\n};\n\nif (typeof exports !== 'undefined') {\n  exports.parseBuffer = ISOBoxer.parseBuffer;\n  exports.addBoxProcessor = ISOBoxer.addBoxProcessor;\n  exports.createFile = ISOBoxer.createFile;\n  exports.createBox = ISOBoxer.createBox;\n  exports.createFullBox = ISOBoxer.createFullBox;\n  exports.Utils = ISOBoxer.Utils;\n}\n\nISOBoxer.Cursor = function (initialOffset) {\n  this.offset = typeof initialOffset == 'undefined' ? 0 : initialOffset;\n};\n\nvar ISOFile = function (arrayBuffer) {\n  this._cursor = new ISOBoxer.Cursor();\n  this.boxes = [];\n\n  if (arrayBuffer) {\n    this._raw = new DataView(arrayBuffer);\n  }\n};\n\nISOFile.prototype.fetch = function (type) {\n  var result = this.fetchAll(type, true);\n  return result.length ? result[0] : null;\n};\n\nISOFile.prototype.fetchAll = function (type, returnEarly) {\n  var result = [];\n\n  ISOFile._sweep.call(this, type, result, returnEarly);\n\n  return result;\n};\n\nISOFile.prototype.parse = function () {\n  this._cursor.offset = 0;\n  this.boxes = [];\n\n  while (this._cursor.offset < this._raw.byteLength) {\n    var box = ISOBox.parse(this); // Box could not be parsed\n\n    if (typeof box.type === 'undefined') break;\n    this.boxes.push(box);\n  }\n\n  return this;\n};\n\nISOFile._sweep = function (type, result, returnEarly) {\n  if (this.type && this.type == type) result.push(this);\n\n  for (var box in this.boxes) {\n    if (result.length && returnEarly) return;\n\n    ISOFile._sweep.call(this.boxes[box], type, result, returnEarly);\n  }\n};\n\nISOFile.prototype.write = function () {\n  var length = 0,\n      i;\n\n  for (i = 0; i < this.boxes.length; i++) {\n    length += this.boxes[i].getLength(false);\n  }\n\n  var bytes = new Uint8Array(length);\n  this._rawo = new DataView(bytes.buffer);\n  this.bytes = bytes;\n  this._cursor.offset = 0;\n\n  for (i = 0; i < this.boxes.length; i++) {\n    this.boxes[i].write();\n  }\n\n  return bytes.buffer;\n};\n\nISOFile.prototype.append = function (box, pos) {\n  ISOBoxer.Utils.appendBox(this, box, pos);\n};\n\nvar ISOBox = function () {\n  this._cursor = new ISOBoxer.Cursor();\n};\n\nISOBox.parse = function (parent) {\n  var newBox = new ISOBox();\n  newBox._offset = parent._cursor.offset;\n  newBox._root = parent._root ? parent._root : parent;\n  newBox._raw = parent._raw;\n  newBox._parent = parent;\n\n  newBox._parseBox();\n\n  parent._cursor.offset = newBox._raw.byteOffset + newBox._raw.byteLength;\n  return newBox;\n};\n\nISOBox.create = function (type) {\n  var newBox = new ISOBox();\n  newBox.type = type;\n  newBox.boxes = [];\n  return newBox;\n};\n\nISOBox.prototype._boxContainers = ['dinf', 'edts', 'mdia', 'meco', 'mfra', 'minf', 'moof', 'moov', 'mvex', 'stbl', 'strk', 'traf', 'trak', 'tref', 'udta', 'vttc', 'sinf', 'schi', 'encv', 'enca'];\nISOBox.prototype._boxProcessors = {}; ///////////////////////////////////////////////////////////////////////////////////////////////////\n// Generic read/write functions\n\nISOBox.prototype._procField = function (name, type, size) {\n  if (this._parsing) {\n    this[name] = this._readField(type, size);\n  } else {\n    this._writeField(type, size, this[name]);\n  }\n};\n\nISOBox.prototype._procFieldArray = function (name, length, type, size) {\n  var i;\n\n  if (this._parsing) {\n    this[name] = [];\n\n    for (i = 0; i < length; i++) {\n      this[name][i] = this._readField(type, size);\n    }\n  } else {\n    for (i = 0; i < this[name].length; i++) {\n      this._writeField(type, size, this[name][i]);\n    }\n  }\n};\n\nISOBox.prototype._procFullBox = function () {\n  this._procField('version', 'uint', 8);\n\n  this._procField('flags', 'uint', 24);\n};\n\nISOBox.prototype._procEntries = function (name, length, fn) {\n  var i;\n\n  if (this._parsing) {\n    this[name] = [];\n\n    for (i = 0; i < length; i++) {\n      this[name].push({});\n      fn.call(this, this[name][i]);\n    }\n  } else {\n    for (i = 0; i < length; i++) {\n      fn.call(this, this[name][i]);\n    }\n  }\n};\n\nISOBox.prototype._procSubEntries = function (entry, name, length, fn) {\n  var i;\n\n  if (this._parsing) {\n    entry[name] = [];\n\n    for (i = 0; i < length; i++) {\n      entry[name].push({});\n      fn.call(this, entry[name][i]);\n    }\n  } else {\n    for (i = 0; i < length; i++) {\n      fn.call(this, entry[name][i]);\n    }\n  }\n};\n\nISOBox.prototype._procEntryField = function (entry, name, type, size) {\n  if (this._parsing) {\n    entry[name] = this._readField(type, size);\n  } else {\n    this._writeField(type, size, entry[name]);\n  }\n};\n\nISOBox.prototype._procSubBoxes = function (name, length) {\n  var i;\n\n  if (this._parsing) {\n    this[name] = [];\n\n    for (i = 0; i < length; i++) {\n      this[name].push(ISOBox.parse(this));\n    }\n  } else {\n    for (i = 0; i < length; i++) {\n      if (this._rawo) {\n        this[name][i].write();\n      } else {\n        this.size += this[name][i].getLength();\n      }\n    }\n  }\n}; ///////////////////////////////////////////////////////////////////////////////////////////////////\n// Read/parse functions\n\n\nISOBox.prototype._readField = function (type, size) {\n  switch (type) {\n    case 'uint':\n      return this._readUint(size);\n\n    case 'int':\n      return this._readInt(size);\n\n    case 'template':\n      return this._readTemplate(size);\n\n    case 'string':\n      return size === -1 ? this._readTerminatedString() : this._readString(size);\n\n    case 'data':\n      return this._readData(size);\n\n    case 'utf8':\n      return this._readUTF8String();\n\n    default:\n      return -1;\n  }\n};\n\nISOBox.prototype._readInt = function (size) {\n  var result = null,\n      offset = this._cursor.offset - this._raw.byteOffset;\n\n  switch (size) {\n    case 8:\n      result = this._raw.getInt8(offset);\n      break;\n\n    case 16:\n      result = this._raw.getInt16(offset);\n      break;\n\n    case 32:\n      result = this._raw.getInt32(offset);\n      break;\n\n    case 64:\n      // Warning: JavaScript cannot handle 64-bit integers natively.\n      // This will give unexpected results for integers >= 2^53\n      var s1 = this._raw.getInt32(offset);\n\n      var s2 = this._raw.getInt32(offset + 4);\n\n      result = s1 * Math.pow(2, 32) + s2;\n      break;\n  }\n\n  this._cursor.offset += size >> 3;\n  return result;\n};\n\nISOBox.prototype._readUint = function (size) {\n  var result = null,\n      offset = this._cursor.offset - this._raw.byteOffset,\n      s1,\n      s2;\n\n  switch (size) {\n    case 8:\n      result = this._raw.getUint8(offset);\n      break;\n\n    case 16:\n      result = this._raw.getUint16(offset);\n      break;\n\n    case 24:\n      s1 = this._raw.getUint16(offset);\n      s2 = this._raw.getUint8(offset + 2);\n      result = (s1 << 8) + s2;\n      break;\n\n    case 32:\n      result = this._raw.getUint32(offset);\n      break;\n\n    case 64:\n      // Warning: JavaScript cannot handle 64-bit integers natively.\n      // This will give unexpected results for integers >= 2^53\n      s1 = this._raw.getUint32(offset);\n      s2 = this._raw.getUint32(offset + 4);\n      result = s1 * Math.pow(2, 32) + s2;\n      break;\n  }\n\n  this._cursor.offset += size >> 3;\n  return result;\n};\n\nISOBox.prototype._readString = function (length) {\n  var str = '';\n\n  for (var c = 0; c < length; c++) {\n    var char = this._readUint(8);\n\n    str += String.fromCharCode(char);\n  }\n\n  return str;\n};\n\nISOBox.prototype._readTemplate = function (size) {\n  var pre = this._readUint(size / 2);\n\n  var post = this._readUint(size / 2);\n\n  return pre + post / Math.pow(2, size / 2);\n};\n\nISOBox.prototype._readTerminatedString = function () {\n  var str = '';\n\n  while (this._cursor.offset - this._offset < this._raw.byteLength) {\n    var char = this._readUint(8);\n\n    if (char === 0) break;\n    str += String.fromCharCode(char);\n  }\n\n  return str;\n};\n\nISOBox.prototype._readData = function (size) {\n  var length = size > 0 ? size : this._raw.byteLength - (this._cursor.offset - this._offset);\n\n  if (length > 0) {\n    var data = new Uint8Array(this._raw.buffer, this._cursor.offset, length);\n    this._cursor.offset += length;\n    return data;\n  } else {\n    return null;\n  }\n};\n\nISOBox.prototype._readUTF8String = function () {\n  var length = this._raw.byteLength - (this._cursor.offset - this._offset);\n  var data = null;\n\n  if (length > 0) {\n    data = new DataView(this._raw.buffer, this._cursor.offset, length);\n    this._cursor.offset += length;\n  }\n\n  return data ? ISOBoxer.Utils.dataViewToString(data) : data;\n};\n\nISOBox.prototype._parseBox = function () {\n  this._parsing = true;\n  this._cursor.offset = this._offset; // return immediately if there are not enough bytes to read the header\n\n  if (this._offset + 8 > this._raw.buffer.byteLength) {\n    this._root._incomplete = true;\n    return;\n  }\n\n  this._procField('size', 'uint', 32);\n\n  this._procField('type', 'string', 4);\n\n  if (this.size === 1) {\n    this._procField('largesize', 'uint', 64);\n  }\n\n  if (this.type === 'uuid') {\n    this._procFieldArray('usertype', 16, 'uint', 8);\n  }\n\n  switch (this.size) {\n    case 0:\n      this._raw = new DataView(this._raw.buffer, this._offset, this._raw.byteLength - this._cursor.offset + 8);\n      break;\n\n    case 1:\n      if (this._offset + this.size > this._raw.buffer.byteLength) {\n        this._incomplete = true;\n        this._root._incomplete = true;\n      } else {\n        this._raw = new DataView(this._raw.buffer, this._offset, this.largesize);\n      }\n\n      break;\n\n    default:\n      if (this._offset + this.size > this._raw.buffer.byteLength) {\n        this._incomplete = true;\n        this._root._incomplete = true;\n      } else {\n        this._raw = new DataView(this._raw.buffer, this._offset, this.size);\n      }\n\n  } // additional parsing\n\n\n  if (!this._incomplete) {\n    if (this._boxProcessors[this.type]) {\n      this._boxProcessors[this.type].call(this);\n    }\n\n    if (this._boxContainers.indexOf(this.type) !== -1) {\n      this._parseContainerBox();\n    } else {\n      // Unknown box => read and store box content\n      this._data = this._readData();\n    }\n  }\n};\n\nISOBox.prototype._parseFullBox = function () {\n  this.version = this._readUint(8);\n  this.flags = this._readUint(24);\n};\n\nISOBox.prototype._parseContainerBox = function () {\n  this.boxes = [];\n\n  while (this._cursor.offset - this._raw.byteOffset < this._raw.byteLength) {\n    this.boxes.push(ISOBox.parse(this));\n  }\n}; ///////////////////////////////////////////////////////////////////////////////////////////////////\n// Write functions\n\n\nISOBox.prototype.append = function (box, pos) {\n  ISOBoxer.Utils.appendBox(this, box, pos);\n};\n\nISOBox.prototype.getLength = function () {\n  this._parsing = false;\n  this._rawo = null;\n  this.size = 0;\n\n  this._procField('size', 'uint', 32);\n\n  this._procField('type', 'string', 4);\n\n  if (this.size === 1) {\n    this._procField('largesize', 'uint', 64);\n  }\n\n  if (this.type === 'uuid') {\n    this._procFieldArray('usertype', 16, 'uint', 8);\n  }\n\n  if (this._boxProcessors[this.type]) {\n    this._boxProcessors[this.type].call(this);\n  }\n\n  if (this._boxContainers.indexOf(this.type) !== -1) {\n    for (var i = 0; i < this.boxes.length; i++) {\n      this.size += this.boxes[i].getLength();\n    }\n  }\n\n  if (this._data) {\n    this._writeData(this._data);\n  }\n\n  return this.size;\n};\n\nISOBox.prototype.write = function () {\n  this._parsing = false;\n  this._cursor.offset = this._parent._cursor.offset;\n\n  switch (this.size) {\n    case 0:\n      this._rawo = new DataView(this._parent._rawo.buffer, this._cursor.offset, this.parent._rawo.byteLength - this._cursor.offset);\n      break;\n\n    case 1:\n      this._rawo = new DataView(this._parent._rawo.buffer, this._cursor.offset, this.largesize);\n      break;\n\n    default:\n      this._rawo = new DataView(this._parent._rawo.buffer, this._cursor.offset, this.size);\n  }\n\n  this._procField('size', 'uint', 32);\n\n  this._procField('type', 'string', 4);\n\n  if (this.size === 1) {\n    this._procField('largesize', 'uint', 64);\n  }\n\n  if (this.type === 'uuid') {\n    this._procFieldArray('usertype', 16, 'uint', 8);\n  }\n\n  if (this._boxProcessors[this.type]) {\n    this._boxProcessors[this.type].call(this);\n  }\n\n  if (this._boxContainers.indexOf(this.type) !== -1) {\n    for (var i = 0; i < this.boxes.length; i++) {\n      this.boxes[i].write();\n    }\n  }\n\n  if (this._data) {\n    this._writeData(this._data);\n  }\n\n  this._parent._cursor.offset += this.size;\n  return this.size;\n};\n\nISOBox.prototype._writeInt = function (size, value) {\n  if (this._rawo) {\n    var offset = this._cursor.offset - this._rawo.byteOffset;\n\n    switch (size) {\n      case 8:\n        this._rawo.setInt8(offset, value);\n\n        break;\n\n      case 16:\n        this._rawo.setInt16(offset, value);\n\n        break;\n\n      case 32:\n        this._rawo.setInt32(offset, value);\n\n        break;\n\n      case 64:\n        // Warning: JavaScript cannot handle 64-bit integers natively.\n        // This will give unexpected results for integers >= 2^53\n        var s1 = Math.floor(value / Math.pow(2, 32));\n        var s2 = value - s1 * Math.pow(2, 32);\n\n        this._rawo.setUint32(offset, s1);\n\n        this._rawo.setUint32(offset + 4, s2);\n\n        break;\n    }\n\n    this._cursor.offset += size >> 3;\n  } else {\n    this.size += size >> 3;\n  }\n};\n\nISOBox.prototype._writeUint = function (size, value) {\n  if (this._rawo) {\n    var offset = this._cursor.offset - this._rawo.byteOffset,\n        s1,\n        s2;\n\n    switch (size) {\n      case 8:\n        this._rawo.setUint8(offset, value);\n\n        break;\n\n      case 16:\n        this._rawo.setUint16(offset, value);\n\n        break;\n\n      case 24:\n        s1 = (value & 0xFFFF00) >> 8;\n        s2 = value & 0x0000FF;\n\n        this._rawo.setUint16(offset, s1);\n\n        this._rawo.setUint8(offset + 2, s2);\n\n        break;\n\n      case 32:\n        this._rawo.setUint32(offset, value);\n\n        break;\n\n      case 64:\n        // Warning: JavaScript cannot handle 64-bit integers natively.\n        // This will give unexpected results for integers >= 2^53\n        s1 = Math.floor(value / Math.pow(2, 32));\n        s2 = value - s1 * Math.pow(2, 32);\n\n        this._rawo.setUint32(offset, s1);\n\n        this._rawo.setUint32(offset + 4, s2);\n\n        break;\n    }\n\n    this._cursor.offset += size >> 3;\n  } else {\n    this.size += size >> 3;\n  }\n};\n\nISOBox.prototype._writeString = function (size, str) {\n  for (var c = 0; c < size; c++) {\n    this._writeUint(8, str.charCodeAt(c));\n  }\n};\n\nISOBox.prototype._writeTerminatedString = function (str) {\n  if (str.length === 0) {\n    return;\n  }\n\n  for (var c = 0; c < str.length; c++) {\n    this._writeUint(8, str.charCodeAt(c));\n  }\n\n  this._writeUint(8, 0);\n};\n\nISOBox.prototype._writeTemplate = function (size, value) {\n  var pre = Math.floor(value);\n  var post = (value - pre) * Math.pow(2, size / 2);\n\n  this._writeUint(size / 2, pre);\n\n  this._writeUint(size / 2, post);\n};\n\nISOBox.prototype._writeData = function (data) {\n  var i; //data to copy\n\n  if (data) {\n    if (this._rawo) {\n      //Array and Uint8Array has also to be managed\n      if (data instanceof Array) {\n        var offset = this._cursor.offset - this._rawo.byteOffset;\n\n        for (var i = 0; i < data.length; i++) {\n          this._rawo.setInt8(offset + i, data[i]);\n        }\n\n        this._cursor.offset += data.length;\n      }\n\n      if (data instanceof Uint8Array) {\n        this._root.bytes.set(data, this._cursor.offset);\n\n        this._cursor.offset += data.length;\n      }\n    } else {\n      //nothing to copy only size to compute\n      this.size += data.length;\n    }\n  }\n};\n\nISOBox.prototype._writeUTF8String = function (string) {\n  var u = ISOBoxer.Utils.utf8ToByteArray(string);\n\n  if (this._rawo) {\n    var dataView = new DataView(this._rawo.buffer, this._cursor.offset, u.length);\n\n    for (var i = 0; i < u.length; i++) {\n      dataView.setUint8(i, u[i]);\n    }\n  } else {\n    this.size += u.length;\n  }\n};\n\nISOBox.prototype._writeField = function (type, size, value) {\n  switch (type) {\n    case 'uint':\n      this._writeUint(size, value);\n\n      break;\n\n    case 'int':\n      this._writeInt(size, value);\n\n      break;\n\n    case 'template':\n      this._writeTemplate(size, value);\n\n      break;\n\n    case 'string':\n      if (size == -1) {\n        this._writeTerminatedString(value);\n      } else {\n        this._writeString(size, value);\n      }\n\n      break;\n\n    case 'data':\n      this._writeData(value);\n\n      break;\n\n    case 'utf8':\n      this._writeUTF8String(value);\n\n      break;\n\n    default:\n      break;\n  }\n}; // ISO/IEC 14496-15:2014 - avc1 box\n\n\nISOBox.prototype._boxProcessors['avc1'] = ISOBox.prototype._boxProcessors['encv'] = function () {\n  // SampleEntry fields\n  this._procFieldArray('reserved1', 6, 'uint', 8);\n\n  this._procField('data_reference_index', 'uint', 16); // VisualSampleEntry fields\n\n\n  this._procField('pre_defined1', 'uint', 16);\n\n  this._procField('reserved2', 'uint', 16);\n\n  this._procFieldArray('pre_defined2', 3, 'uint', 32);\n\n  this._procField('width', 'uint', 16);\n\n  this._procField('height', 'uint', 16);\n\n  this._procField('horizresolution', 'template', 32);\n\n  this._procField('vertresolution', 'template', 32);\n\n  this._procField('reserved3', 'uint', 32);\n\n  this._procField('frame_count', 'uint', 16);\n\n  this._procFieldArray('compressorname', 32, 'uint', 8);\n\n  this._procField('depth', 'uint', 16);\n\n  this._procField('pre_defined3', 'int', 16); // AVCSampleEntry fields\n\n\n  this._procField('config', 'data', -1);\n}; // ISO/IEC 14496-12:2012 - 8.7.2 Data Reference Box\n\n\nISOBox.prototype._boxProcessors['dref'] = function () {\n  this._procFullBox();\n\n  this._procField('entry_count', 'uint', 32);\n\n  this._procSubBoxes('entries', this.entry_count);\n}; // ISO/IEC 14496-12:2012 - 8.6.6 Edit List Box\n\n\nISOBox.prototype._boxProcessors['elst'] = function () {\n  this._procFullBox();\n\n  this._procField('entry_count', 'uint', 32);\n\n  this._procEntries('entries', this.entry_count, function (entry) {\n    this._procEntryField(entry, 'segment_duration', 'uint', this.version === 1 ? 64 : 32);\n\n    this._procEntryField(entry, 'media_time', 'int', this.version === 1 ? 64 : 32);\n\n    this._procEntryField(entry, 'media_rate_integer', 'int', 16);\n\n    this._procEntryField(entry, 'media_rate_fraction', 'int', 16);\n  });\n}; // ISO/IEC 23009-1:2014 - 5.10.3.3 Event Message Box\n\n\nISOBox.prototype._boxProcessors['emsg'] = function () {\n  this._procFullBox();\n\n  if (this.version == 1) {\n    this._procField('timescale', 'uint', 32);\n\n    this._procField('presentation_time', 'uint', 64);\n\n    this._procField('event_duration', 'uint', 32);\n\n    this._procField('id', 'uint', 32);\n\n    this._procField('scheme_id_uri', 'string', -1);\n\n    this._procField('value', 'string', -1);\n  } else {\n    this._procField('scheme_id_uri', 'string', -1);\n\n    this._procField('value', 'string', -1);\n\n    this._procField('timescale', 'uint', 32);\n\n    this._procField('presentation_time_delta', 'uint', 32);\n\n    this._procField('event_duration', 'uint', 32);\n\n    this._procField('id', 'uint', 32);\n  }\n\n  this._procField('message_data', 'data', -1);\n}; // ISO/IEC 14496-12:2012 - 8.1.2 Free Space Box\n\n\nISOBox.prototype._boxProcessors['free'] = ISOBox.prototype._boxProcessors['skip'] = function () {\n  this._procField('data', 'data', -1);\n}; // ISO/IEC 14496-12:2012 - 8.12.2 Original Format Box\n\n\nISOBox.prototype._boxProcessors['frma'] = function () {\n  this._procField('data_format', 'uint', 32);\n}; // ISO/IEC 14496-12:2012 - 4.3 File Type Box / 8.16.2 Segment Type Box\n\n\nISOBox.prototype._boxProcessors['ftyp'] = ISOBox.prototype._boxProcessors['styp'] = function () {\n  this._procField('major_brand', 'string', 4);\n\n  this._procField('minor_version', 'uint', 32);\n\n  var nbCompatibleBrands = -1;\n\n  if (this._parsing) {\n    nbCompatibleBrands = (this._raw.byteLength - (this._cursor.offset - this._raw.byteOffset)) / 4;\n  }\n\n  this._procFieldArray('compatible_brands', nbCompatibleBrands, 'string', 4);\n}; // ISO/IEC 14496-12:2012 - 8.4.3 Handler Reference Box\n\n\nISOBox.prototype._boxProcessors['hdlr'] = function () {\n  this._procFullBox();\n\n  this._procField('pre_defined', 'uint', 32);\n\n  this._procField('handler_type', 'string', 4);\n\n  this._procFieldArray('reserved', 3, 'uint', 32);\n\n  this._procField('name', 'string', -1);\n}; // ISO/IEC 14496-12:2012 - 8.1.1 Media Data Box\n\n\nISOBox.prototype._boxProcessors['mdat'] = function () {\n  this._procField('data', 'data', -1);\n}; // ISO/IEC 14496-12:2012 - 8.4.2 Media Header Box\n\n\nISOBox.prototype._boxProcessors['mdhd'] = function () {\n  this._procFullBox();\n\n  this._procField('creation_time', 'uint', this.version == 1 ? 64 : 32);\n\n  this._procField('modification_time', 'uint', this.version == 1 ? 64 : 32);\n\n  this._procField('timescale', 'uint', 32);\n\n  this._procField('duration', 'uint', this.version == 1 ? 64 : 32);\n\n  if (!this._parsing && typeof this.language === 'string') {\n    // In case of writing and language has been set as a string, then convert it into char codes array\n    this.language = this.language.charCodeAt(0) - 0x60 << 10 | this.language.charCodeAt(1) - 0x60 << 5 | this.language.charCodeAt(2) - 0x60;\n  }\n\n  this._procField('language', 'uint', 16);\n\n  if (this._parsing) {\n    this.language = String.fromCharCode((this.language >> 10 & 0x1F) + 0x60, (this.language >> 5 & 0x1F) + 0x60, (this.language & 0x1F) + 0x60);\n  }\n\n  this._procField('pre_defined', 'uint', 16);\n}; // ISO/IEC 14496-12:2012 - 8.8.2 Movie Extends Header Box\n\n\nISOBox.prototype._boxProcessors['mehd'] = function () {\n  this._procFullBox();\n\n  this._procField('fragment_duration', 'uint', this.version == 1 ? 64 : 32);\n}; // ISO/IEC 14496-12:2012 - 8.8.5 Movie Fragment Header Box\n\n\nISOBox.prototype._boxProcessors['mfhd'] = function () {\n  this._procFullBox();\n\n  this._procField('sequence_number', 'uint', 32);\n}; // ISO/IEC 14496-12:2012 - 8.8.11 Movie Fragment Random Access Box\n\n\nISOBox.prototype._boxProcessors['mfro'] = function () {\n  this._procFullBox();\n\n  this._procField('mfra_size', 'uint', 32); // Called mfra_size to distinguish from the normal \"size\" attribute of a box\n\n}; // ISO/IEC 14496-12:2012 - 8.5.2.2 mp4a box (use AudioSampleEntry definition and naming)\n\n\nISOBox.prototype._boxProcessors['mp4a'] = ISOBox.prototype._boxProcessors['enca'] = function () {\n  // SampleEntry fields\n  this._procFieldArray('reserved1', 6, 'uint', 8);\n\n  this._procField('data_reference_index', 'uint', 16); // AudioSampleEntry fields\n\n\n  this._procFieldArray('reserved2', 2, 'uint', 32);\n\n  this._procField('channelcount', 'uint', 16);\n\n  this._procField('samplesize', 'uint', 16);\n\n  this._procField('pre_defined', 'uint', 16);\n\n  this._procField('reserved3', 'uint', 16);\n\n  this._procField('samplerate', 'template', 32); // ESDescriptor fields\n\n\n  this._procField('esds', 'data', -1);\n}; // ISO/IEC 14496-12:2012 - 8.2.2 Movie Header Box\n\n\nISOBox.prototype._boxProcessors['mvhd'] = function () {\n  this._procFullBox();\n\n  this._procField('creation_time', 'uint', this.version == 1 ? 64 : 32);\n\n  this._procField('modification_time', 'uint', this.version == 1 ? 64 : 32);\n\n  this._procField('timescale', 'uint', 32);\n\n  this._procField('duration', 'uint', this.version == 1 ? 64 : 32);\n\n  this._procField('rate', 'template', 32);\n\n  this._procField('volume', 'template', 16);\n\n  this._procField('reserved1', 'uint', 16);\n\n  this._procFieldArray('reserved2', 2, 'uint', 32);\n\n  this._procFieldArray('matrix', 9, 'template', 32);\n\n  this._procFieldArray('pre_defined', 6, 'uint', 32);\n\n  this._procField('next_track_ID', 'uint', 32);\n}; // ISO/IEC 14496-30:2014 - WebVTT Cue Payload Box.\n\n\nISOBox.prototype._boxProcessors['payl'] = function () {\n  this._procField('cue_text', 'utf8');\n}; //ISO/IEC 23001-7:2011 - 8.1 Protection System Specific Header Box\n\n\nISOBox.prototype._boxProcessors['pssh'] = function () {\n  this._procFullBox();\n\n  this._procFieldArray('SystemID', 16, 'uint', 8);\n\n  this._procField('DataSize', 'uint', 32);\n\n  this._procFieldArray('Data', this.DataSize, 'uint', 8);\n}; // ISO/IEC 14496-12:2012 - 8.12.5 Scheme Type Box\n\n\nISOBox.prototype._boxProcessors['schm'] = function () {\n  this._procFullBox();\n\n  this._procField('scheme_type', 'uint', 32);\n\n  this._procField('scheme_version', 'uint', 32);\n\n  if (this.flags & 0x000001) {\n    this._procField('scheme_uri', 'string', -1);\n  }\n}; // ISO/IEC 14496-12:2012 - 8.6.4.1 sdtp box \n\n\nISOBox.prototype._boxProcessors['sdtp'] = function () {\n  this._procFullBox();\n\n  var sample_count = -1;\n\n  if (this._parsing) {\n    sample_count = this._raw.byteLength - (this._cursor.offset - this._raw.byteOffset);\n  }\n\n  this._procFieldArray('sample_dependency_table', sample_count, 'uint', 8);\n}; // ISO/IEC 14496-12:2012 - 8.16.3 Segment Index Box\n\n\nISOBox.prototype._boxProcessors['sidx'] = function () {\n  this._procFullBox();\n\n  this._procField('reference_ID', 'uint', 32);\n\n  this._procField('timescale', 'uint', 32);\n\n  this._procField('earliest_presentation_time', 'uint', this.version == 1 ? 64 : 32);\n\n  this._procField('first_offset', 'uint', this.version == 1 ? 64 : 32);\n\n  this._procField('reserved', 'uint', 16);\n\n  this._procField('reference_count', 'uint', 16);\n\n  this._procEntries('references', this.reference_count, function (entry) {\n    if (!this._parsing) {\n      entry.reference = (entry.reference_type & 0x00000001) << 31;\n      entry.reference |= entry.referenced_size & 0x7FFFFFFF;\n      entry.sap = (entry.starts_with_SAP & 0x00000001) << 31;\n      entry.sap |= (entry.SAP_type & 0x00000003) << 28;\n      entry.sap |= entry.SAP_delta_time & 0x0FFFFFFF;\n    }\n\n    this._procEntryField(entry, 'reference', 'uint', 32);\n\n    this._procEntryField(entry, 'subsegment_duration', 'uint', 32);\n\n    this._procEntryField(entry, 'sap', 'uint', 32);\n\n    if (this._parsing) {\n      entry.reference_type = entry.reference >> 31 & 0x00000001;\n      entry.referenced_size = entry.reference & 0x7FFFFFFF;\n      entry.starts_with_SAP = entry.sap >> 31 & 0x00000001;\n      entry.SAP_type = entry.sap >> 28 & 0x00000007;\n      entry.SAP_delta_time = entry.sap & 0x0FFFFFFF;\n    }\n  });\n}; // ISO/IEC 14496-12:2012 - 8.4.5.3 Sound Media Header Box\n\n\nISOBox.prototype._boxProcessors['smhd'] = function () {\n  this._procFullBox();\n\n  this._procField('balance', 'uint', 16);\n\n  this._procField('reserved', 'uint', 16);\n}; // ISO/IEC 14496-12:2012 - 8.16.4 Subsegment Index Box\n\n\nISOBox.prototype._boxProcessors['ssix'] = function () {\n  this._procFullBox();\n\n  this._procField('subsegment_count', 'uint', 32);\n\n  this._procEntries('subsegments', this.subsegment_count, function (subsegment) {\n    this._procEntryField(subsegment, 'ranges_count', 'uint', 32);\n\n    this._procSubEntries(subsegment, 'ranges', subsegment.ranges_count, function (range) {\n      this._procEntryField(range, 'level', 'uint', 8);\n\n      this._procEntryField(range, 'range_size', 'uint', 24);\n    });\n  });\n}; // ISO/IEC 14496-12:2012 - 8.5.2 Sample Description Box\n\n\nISOBox.prototype._boxProcessors['stsd'] = function () {\n  this._procFullBox();\n\n  this._procField('entry_count', 'uint', 32);\n\n  this._procSubBoxes('entries', this.entry_count);\n}; // ISO/IEC 14496-12:2015 - 8.7.7 Sub-Sample Information Box\n\n\nISOBox.prototype._boxProcessors['subs'] = function () {\n  this._procFullBox();\n\n  this._procField('entry_count', 'uint', 32);\n\n  this._procEntries('entries', this.entry_count, function (entry) {\n    this._procEntryField(entry, 'sample_delta', 'uint', 32);\n\n    this._procEntryField(entry, 'subsample_count', 'uint', 16);\n\n    this._procSubEntries(entry, 'subsamples', entry.subsample_count, function (subsample) {\n      this._procEntryField(subsample, 'subsample_size', 'uint', this.version === 1 ? 32 : 16);\n\n      this._procEntryField(subsample, 'subsample_priority', 'uint', 8);\n\n      this._procEntryField(subsample, 'discardable', 'uint', 8);\n\n      this._procEntryField(subsample, 'codec_specific_parameters', 'uint', 32);\n    });\n  });\n}; //ISO/IEC 23001-7:2011 - 8.2 Track Encryption Box\n\n\nISOBox.prototype._boxProcessors['tenc'] = function () {\n  this._procFullBox();\n\n  this._procField('default_IsEncrypted', 'uint', 24);\n\n  this._procField('default_IV_size', 'uint', 8);\n\n  this._procFieldArray('default_KID', 16, 'uint', 8);\n}; // ISO/IEC 14496-12:2012 - 8.8.12 Track Fragmnent Decode Time\n\n\nISOBox.prototype._boxProcessors['tfdt'] = function () {\n  this._procFullBox();\n\n  this._procField('baseMediaDecodeTime', 'uint', this.version == 1 ? 64 : 32);\n}; // ISO/IEC 14496-12:2012 - 8.8.7 Track Fragment Header Box\n\n\nISOBox.prototype._boxProcessors['tfhd'] = function () {\n  this._procFullBox();\n\n  this._procField('track_ID', 'uint', 32);\n\n  if (this.flags & 0x01) this._procField('base_data_offset', 'uint', 64);\n  if (this.flags & 0x02) this._procField('sample_description_offset', 'uint', 32);\n  if (this.flags & 0x08) this._procField('default_sample_duration', 'uint', 32);\n  if (this.flags & 0x10) this._procField('default_sample_size', 'uint', 32);\n  if (this.flags & 0x20) this._procField('default_sample_flags', 'uint', 32);\n}; // ISO/IEC 14496-12:2012 - 8.8.10 Track Fragment Random Access Box\n\n\nISOBox.prototype._boxProcessors['tfra'] = function () {\n  this._procFullBox();\n\n  this._procField('track_ID', 'uint', 32);\n\n  if (!this._parsing) {\n    this.reserved = 0;\n    this.reserved |= (this.length_size_of_traf_num & 0x00000030) << 4;\n    this.reserved |= (this.length_size_of_trun_num & 0x0000000C) << 2;\n    this.reserved |= this.length_size_of_sample_num & 0x00000003;\n  }\n\n  this._procField('reserved', 'uint', 32);\n\n  if (this._parsing) {\n    this.length_size_of_traf_num = (this.reserved & 0x00000030) >> 4;\n    this.length_size_of_trun_num = (this.reserved & 0x0000000C) >> 2;\n    this.length_size_of_sample_num = this.reserved & 0x00000003;\n  }\n\n  this._procField('number_of_entry', 'uint', 32);\n\n  this._procEntries('entries', this.number_of_entry, function (entry) {\n    this._procEntryField(entry, 'time', 'uint', this.version === 1 ? 64 : 32);\n\n    this._procEntryField(entry, 'moof_offset', 'uint', this.version === 1 ? 64 : 32);\n\n    this._procEntryField(entry, 'traf_number', 'uint', (this.length_size_of_traf_num + 1) * 8);\n\n    this._procEntryField(entry, 'trun_number', 'uint', (this.length_size_of_trun_num + 1) * 8);\n\n    this._procEntryField(entry, 'sample_number', 'uint', (this.length_size_of_sample_num + 1) * 8);\n  });\n}; // ISO/IEC 14496-12:2012 - 8.3.2 Track Header Box\n\n\nISOBox.prototype._boxProcessors['tkhd'] = function () {\n  this._procFullBox();\n\n  this._procField('creation_time', 'uint', this.version == 1 ? 64 : 32);\n\n  this._procField('modification_time', 'uint', this.version == 1 ? 64 : 32);\n\n  this._procField('track_ID', 'uint', 32);\n\n  this._procField('reserved1', 'uint', 32);\n\n  this._procField('duration', 'uint', this.version == 1 ? 64 : 32);\n\n  this._procFieldArray('reserved2', 2, 'uint', 32);\n\n  this._procField('layer', 'uint', 16);\n\n  this._procField('alternate_group', 'uint', 16);\n\n  this._procField('volume', 'template', 16);\n\n  this._procField('reserved3', 'uint', 16);\n\n  this._procFieldArray('matrix', 9, 'template', 32);\n\n  this._procField('width', 'template', 32);\n\n  this._procField('height', 'template', 32);\n}; // ISO/IEC 14496-12:2012 - 8.8.3 Track Extends Box\n\n\nISOBox.prototype._boxProcessors['trex'] = function () {\n  this._procFullBox();\n\n  this._procField('track_ID', 'uint', 32);\n\n  this._procField('default_sample_description_index', 'uint', 32);\n\n  this._procField('default_sample_duration', 'uint', 32);\n\n  this._procField('default_sample_size', 'uint', 32);\n\n  this._procField('default_sample_flags', 'uint', 32);\n}; // ISO/IEC 14496-12:2012 - 8.8.8 Track Run Box\n// Note: the 'trun' box has a direct relation to the 'tfhd' box for defaults.\n// These defaults are not set explicitly here, but are left to resolve for the user.\n\n\nISOBox.prototype._boxProcessors['trun'] = function () {\n  this._procFullBox();\n\n  this._procField('sample_count', 'uint', 32);\n\n  if (this.flags & 0x1) this._procField('data_offset', 'int', 32);\n  if (this.flags & 0x4) this._procField('first_sample_flags', 'uint', 32);\n\n  this._procEntries('samples', this.sample_count, function (sample) {\n    if (this.flags & 0x100) this._procEntryField(sample, 'sample_duration', 'uint', 32);\n    if (this.flags & 0x200) this._procEntryField(sample, 'sample_size', 'uint', 32);\n    if (this.flags & 0x400) this._procEntryField(sample, 'sample_flags', 'uint', 32);\n    if (this.flags & 0x800) this._procEntryField(sample, 'sample_composition_time_offset', this.version === 1 ? 'int' : 'uint', 32);\n  });\n}; // ISO/IEC 14496-12:2012 - 8.7.2 Data Reference Box\n\n\nISOBox.prototype._boxProcessors['url '] = ISOBox.prototype._boxProcessors['urn '] = function () {\n  this._procFullBox();\n\n  if (this.type === 'urn ') {\n    this._procField('name', 'string', -1);\n  }\n\n  this._procField('location', 'string', -1);\n}; // ISO/IEC 14496-30:2014 - WebVTT Source Label Box\n\n\nISOBox.prototype._boxProcessors['vlab'] = function () {\n  this._procField('source_label', 'utf8');\n}; // ISO/IEC 14496-12:2012 - 8.4.5.2 Video Media Header Box\n\n\nISOBox.prototype._boxProcessors['vmhd'] = function () {\n  this._procFullBox();\n\n  this._procField('graphicsmode', 'uint', 16);\n\n  this._procFieldArray('opcolor', 3, 'uint', 16);\n}; // ISO/IEC 14496-30:2014 - WebVTT Configuration Box\n\n\nISOBox.prototype._boxProcessors['vttC'] = function () {\n  this._procField('config', 'utf8');\n}; // ISO/IEC 14496-30:2014 - WebVTT Empty Sample Box\n\n\nISOBox.prototype._boxProcessors['vtte'] = function () {// Nothing should happen here.\n};","map":{"version":3,"names":["ISOBoxer","parseBuffer","arrayBuffer","ISOFile","parse","addBoxProcessor","type","parser","ISOBox","prototype","_boxProcessors","createFile","createBox","parent","pos","newBox","create","append","createFullBox","version","flags","Utils","dataViewToString","dataView","encoding","impliedEncoding","TextDecoder","decode","a","i","byteLength","c","getUint8","push","String","fromCharCode","join","utf8ToByteArray","string","u","TextEncoder","encode","length","charCodeAt","appendBox","box","_offset","_cursor","offset","_root","_raw","_parent","undefined","boxes","index","splice","exports","Cursor","initialOffset","DataView","fetch","result","fetchAll","returnEarly","_sweep","call","write","getLength","bytes","Uint8Array","_rawo","buffer","_parseBox","byteOffset","_boxContainers","_procField","name","size","_parsing","_readField","_writeField","_procFieldArray","_procFullBox","_procEntries","fn","_procSubEntries","entry","_procEntryField","_procSubBoxes","_readUint","_readInt","_readTemplate","_readTerminatedString","_readString","_readData","_readUTF8String","getInt8","getInt16","getInt32","s1","s2","Math","pow","getUint16","getUint32","str","char","pre","post","data","_incomplete","largesize","indexOf","_parseContainerBox","_data","_parseFullBox","_writeData","_writeInt","value","setInt8","setInt16","setInt32","floor","setUint32","_writeUint","setUint8","setUint16","_writeString","_writeTerminatedString","_writeTemplate","Array","set","_writeUTF8String","entry_count","nbCompatibleBrands","language","DataSize","sample_count","reference_count","reference","reference_type","referenced_size","sap","starts_with_SAP","SAP_type","SAP_delta_time","subsegment_count","subsegment","ranges_count","range","subsample_count","subsample","reserved","length_size_of_traf_num","length_size_of_trun_num","length_size_of_sample_num","number_of_entry","sample"],"sources":["/home/landsys/react-node-video-streaming/client/node_modules/codem-isoboxer/dist/iso_boxer.js"],"sourcesContent":["/*! codem-isoboxer v0.3.6 https://github.com/madebyhiro/codem-isoboxer/blob/master/LICENSE.txt */\nvar ISOBoxer = {};\n\nISOBoxer.parseBuffer = function(arrayBuffer) {\n  return new ISOFile(arrayBuffer).parse();\n};\n\nISOBoxer.addBoxProcessor = function(type, parser) {\n  if (typeof type !== 'string' || typeof parser !== 'function') {\n    return;\n  }\n  ISOBox.prototype._boxProcessors[type] = parser;\n};\n\nISOBoxer.createFile = function() {\n  return new ISOFile();\n};\n\n// See ISOBoxer.append() for 'pos' parameter syntax\nISOBoxer.createBox = function(type, parent, pos) {\n  var newBox = ISOBox.create(type);\n  if (parent) {\n    parent.append(newBox, pos);\n  }\n  return newBox;\n};\n\n// See ISOBoxer.append() for 'pos' parameter syntax\nISOBoxer.createFullBox = function(type, parent, pos) {\n  var newBox = ISOBoxer.createBox(type, parent, pos);\n  newBox.version = 0;\n  newBox.flags = 0;\n  return newBox;\n};\n\nISOBoxer.Utils = {};\nISOBoxer.Utils.dataViewToString = function(dataView, encoding) {\n  var impliedEncoding = encoding || 'utf-8';\n  if (typeof TextDecoder !== 'undefined') {\n    return new TextDecoder(impliedEncoding).decode(dataView);\n  }\n  var a = [];\n  var i = 0;\n\n  if (impliedEncoding === 'utf-8') {\n    /* The following algorithm is essentially a rewrite of the UTF8.decode at\n    http://bannister.us/weblog/2007/simple-base64-encodedecode-javascript/\n    */\n\n    while (i < dataView.byteLength) {\n      var c = dataView.getUint8(i++);\n      if (c < 0x80) {\n        // 1-byte character (7 bits)\n      } else if (c < 0xe0) {\n        // 2-byte character (11 bits)\n        c = (c & 0x1f) << 6;\n        c |= (dataView.getUint8(i++) & 0x3f);\n      } else if (c < 0xf0) {\n        // 3-byte character (16 bits)\n        c = (c & 0xf) << 12;\n        c |= (dataView.getUint8(i++) & 0x3f) << 6;\n        c |= (dataView.getUint8(i++) & 0x3f);\n      } else {\n        // 4-byte character (21 bits)\n        c = (c & 0x7) << 18;\n        c |= (dataView.getUint8(i++) & 0x3f) << 12;\n        c |= (dataView.getUint8(i++) & 0x3f) << 6;\n        c |= (dataView.getUint8(i++) & 0x3f);\n      }\n      a.push(String.fromCharCode(c));\n    }\n  } else { // Just map byte-by-byte (probably wrong)\n    while (i < dataView.byteLength) {\n      a.push(String.fromCharCode(dataView.getUint8(i++)));\n    }\n  }\n  return a.join('');\n};\n\nISOBoxer.Utils.utf8ToByteArray = function(string) {\n  // Only UTF-8 encoding is supported by TextEncoder\n  var u, i;\n  if (typeof TextEncoder !== 'undefined') {\n    u = new TextEncoder().encode(string);\n  } else {\n    u = [];\n    for (i = 0; i < string.length; ++i) {\n      var c = string.charCodeAt(i);\n      if (c < 0x80) {\n        u.push(c);\n      } else if (c < 0x800) {\n        u.push(0xC0 | (c >> 6));\n        u.push(0x80 | (63 & c));\n      } else if (c < 0x10000) {\n        u.push(0xE0 | (c >> 12));\n        u.push(0x80 | (63 & (c >> 6)));\n        u.push(0x80 | (63 & c));\n      } else {\n        u.push(0xF0 | (c >> 18));\n        u.push(0x80 | (63 & (c >> 12)));\n        u.push(0x80 | (63 & (c >> 6)));\n        u.push(0x80 | (63 & c));\n      }\n    }\n  }\n  return u;\n};\n\n// Method to append a box in the list of child boxes\n// The 'pos' parameter can be either:\n//   - (number) a position index at which to insert the new box\n//   - (string) the type of the box after which to insert the new box\n//   - (object) the box after which to insert the new box\nISOBoxer.Utils.appendBox = function(parent, box, pos) {\n  box._offset = parent._cursor.offset;\n  box._root = (parent._root ? parent._root : parent);\n  box._raw = parent._raw;\n  box._parent = parent;\n\n  if (pos === -1) {\n    // The new box is a sub-box of the parent but not added in boxes array,\n    // for example when the new box is set as an entry (see dref and stsd for example)\n    return;\n  }\n\n  if (pos === undefined || pos === null) {\n    parent.boxes.push(box);\n    return;\n  }\n\n  var index = -1,\n      type;\n\n  if (typeof pos === \"number\") {\n    index = pos;\n  } else {\n    if (typeof pos === \"string\") {\n      type = pos;\n    } else if (typeof pos === \"object\" && pos.type) {\n      type = pos.type;\n    } else {\n      parent.boxes.push(box);\n      return;\n    }\n\n    for (var i = 0; i < parent.boxes.length; i++) {\n      if (type === parent.boxes[i].type) {\n        index = i + 1;\n        break;\n      }\n    }\n  }\n  parent.boxes.splice(index, 0, box);\n};\n\nif (typeof exports !== 'undefined') {\n  exports.parseBuffer     = ISOBoxer.parseBuffer;\n  exports.addBoxProcessor = ISOBoxer.addBoxProcessor;\n  exports.createFile      = ISOBoxer.createFile;\n  exports.createBox       = ISOBoxer.createBox;\n  exports.createFullBox   = ISOBoxer.createFullBox;\n  exports.Utils           = ISOBoxer.Utils;\n}\n\nISOBoxer.Cursor = function(initialOffset) {\n  this.offset = (typeof initialOffset == 'undefined' ? 0 : initialOffset);\n};\n\nvar ISOFile = function(arrayBuffer) {\n  this._cursor = new ISOBoxer.Cursor();\n  this.boxes = [];\n  if (arrayBuffer) {\n    this._raw = new DataView(arrayBuffer);\n  }\n};\n\nISOFile.prototype.fetch = function(type) {\n  var result = this.fetchAll(type, true);\n  return (result.length ? result[0] : null);\n};\n\nISOFile.prototype.fetchAll = function(type, returnEarly) {\n  var result = [];\n  ISOFile._sweep.call(this, type, result, returnEarly);\n  return result;\n};\n\nISOFile.prototype.parse = function() {\n  this._cursor.offset = 0;\n  this.boxes = [];\n  while (this._cursor.offset < this._raw.byteLength) {\n    var box = ISOBox.parse(this);\n\n    // Box could not be parsed\n    if (typeof box.type === 'undefined') break;\n\n    this.boxes.push(box);\n  }\n  return this;\n};\n\nISOFile._sweep = function(type, result, returnEarly) {\n  if (this.type && this.type == type) result.push(this);\n  for (var box in this.boxes) {\n    if (result.length && returnEarly) return;\n    ISOFile._sweep.call(this.boxes[box], type, result, returnEarly);\n  }\n};\n\nISOFile.prototype.write = function() {\n\n  var length = 0,\n      i;\n\n  for (i = 0; i < this.boxes.length; i++) {\n    length += this.boxes[i].getLength(false);\n  }\n\n  var bytes = new Uint8Array(length);\n  this._rawo = new DataView(bytes.buffer);\n  this.bytes = bytes;\n  this._cursor.offset = 0;\n\n  for (i = 0; i < this.boxes.length; i++) {\n    this.boxes[i].write();\n  }\n\n  return bytes.buffer;\n};\n\nISOFile.prototype.append = function(box, pos) {\n  ISOBoxer.Utils.appendBox(this, box, pos);\n};\nvar ISOBox = function() {\n  this._cursor = new ISOBoxer.Cursor();\n};\n\nISOBox.parse = function(parent) {\n  var newBox = new ISOBox();\n  newBox._offset = parent._cursor.offset;\n  newBox._root = (parent._root ? parent._root : parent);\n  newBox._raw = parent._raw;\n  newBox._parent = parent;\n  newBox._parseBox();\n  parent._cursor.offset = newBox._raw.byteOffset + newBox._raw.byteLength;\n  return newBox;\n};\n\nISOBox.create = function(type) {\n  var newBox = new ISOBox();\n  newBox.type = type;\n  newBox.boxes = [];\n  return newBox;\n};\n\nISOBox.prototype._boxContainers = ['dinf', 'edts', 'mdia', 'meco', 'mfra', 'minf', 'moof', 'moov', 'mvex', 'stbl', 'strk', 'traf', 'trak', 'tref', 'udta', 'vttc', 'sinf', 'schi', 'encv', 'enca'];\n\nISOBox.prototype._boxProcessors = {};\n\n///////////////////////////////////////////////////////////////////////////////////////////////////\n// Generic read/write functions\n\nISOBox.prototype._procField = function (name, type, size) {\n  if (this._parsing) {\n    this[name] = this._readField(type, size);\n  }\n  else {\n    this._writeField(type, size, this[name]);\n  }\n};\n\nISOBox.prototype._procFieldArray = function (name, length, type, size) {\n  var i;\n  if (this._parsing) {\n    this[name] = [];\n    for (i = 0; i < length; i++) {\n      this[name][i] = this._readField(type, size);\n    }\n  }\n  else {\n    for (i = 0; i < this[name].length; i++) {\n      this._writeField(type, size, this[name][i]);\n    }\n  }\n};\n\nISOBox.prototype._procFullBox = function() {\n  this._procField('version', 'uint', 8);\n  this._procField('flags', 'uint', 24);\n};\n\nISOBox.prototype._procEntries = function(name, length, fn) {\n  var i;\n  if (this._parsing) {\n    this[name] = [];\n    for (i = 0; i < length; i++) {\n      this[name].push({});\n      fn.call(this, this[name][i]);\n    }\n  }\n  else {\n    for (i = 0; i < length; i++) {\n      fn.call(this, this[name][i]);\n    }\n  }\n};\n\nISOBox.prototype._procSubEntries = function(entry, name, length, fn) {\n  var i;\n  if (this._parsing) {\n    entry[name] = [];\n    for (i = 0; i < length; i++) {\n      entry[name].push({});\n      fn.call(this, entry[name][i]);\n    }\n  }\n  else {\n    for (i = 0; i < length; i++) {\n      fn.call(this, entry[name][i]);\n    }\n  }\n};\n\nISOBox.prototype._procEntryField = function (entry, name, type, size) {\n  if (this._parsing) {\n    entry[name] = this._readField(type, size);\n  }\n  else {\n    this._writeField(type, size, entry[name]);\n  }\n};\n\nISOBox.prototype._procSubBoxes = function(name, length) {\n  var i;\n  if (this._parsing) {\n    this[name] = [];\n    for (i = 0; i < length; i++) {\n      this[name].push(ISOBox.parse(this));\n    }\n  }\n  else {\n    for (i = 0; i < length; i++) {\n      if (this._rawo) {\n        this[name][i].write();\n      } else {\n        this.size += this[name][i].getLength();\n      }\n    }\n  }\n};\n\n///////////////////////////////////////////////////////////////////////////////////////////////////\n// Read/parse functions\n\nISOBox.prototype._readField = function(type, size) {\n  switch (type) {\n    case 'uint':\n      return this._readUint(size);\n    case 'int':\n      return this._readInt(size);\n    case 'template':\n      return this._readTemplate(size);\n    case 'string':\n      return (size === -1) ? this._readTerminatedString() : this._readString(size);\n    case 'data':\n      return this._readData(size);\n    case 'utf8':\n      return this._readUTF8String();\n    default:\n      return -1;\n  }\n};\n\nISOBox.prototype._readInt = function(size) {\n  var result = null,\n      offset = this._cursor.offset - this._raw.byteOffset;\n  switch(size) {\n  case 8:\n    result = this._raw.getInt8(offset);\n    break;\n  case 16:\n    result = this._raw.getInt16(offset);\n    break;\n  case 32:\n    result = this._raw.getInt32(offset);\n    break;\n  case 64:\n    // Warning: JavaScript cannot handle 64-bit integers natively.\n    // This will give unexpected results for integers >= 2^53\n    var s1 = this._raw.getInt32(offset);\n    var s2 = this._raw.getInt32(offset + 4);\n    result = (s1 * Math.pow(2,32)) + s2;\n    break;\n  }\n  this._cursor.offset += (size >> 3);\n  return result;\n};\n\nISOBox.prototype._readUint = function(size) {\n  var result = null,\n      offset = this._cursor.offset - this._raw.byteOffset,\n      s1, s2;\n  switch(size) {\n  case 8:\n    result = this._raw.getUint8(offset);\n    break;\n  case 16:\n    result = this._raw.getUint16(offset);\n    break;\n  case 24:\n    s1 = this._raw.getUint16(offset);\n    s2 = this._raw.getUint8(offset + 2);\n    result = (s1 << 8) + s2;\n    break;\n  case 32:\n    result = this._raw.getUint32(offset);\n    break;\n  case 64:\n    // Warning: JavaScript cannot handle 64-bit integers natively.\n    // This will give unexpected results for integers >= 2^53\n    s1 = this._raw.getUint32(offset);\n    s2 = this._raw.getUint32(offset + 4);\n    result = (s1 * Math.pow(2,32)) + s2;\n    break;\n  }\n  this._cursor.offset += (size >> 3);\n  return result;\n};\n\nISOBox.prototype._readString = function(length) {\n  var str = '';\n  for (var c = 0; c < length; c++) {\n    var char = this._readUint(8);\n    str += String.fromCharCode(char);\n  }\n  return str;\n};\n\nISOBox.prototype._readTemplate = function(size) {\n  var pre = this._readUint(size / 2);\n  var post = this._readUint(size / 2);\n  return pre + (post / Math.pow(2, size / 2));\n};\n\nISOBox.prototype._readTerminatedString = function() {\n  var str = '';\n  while (this._cursor.offset - this._offset < this._raw.byteLength) {\n    var char = this._readUint(8);\n    if (char === 0) break;\n    str += String.fromCharCode(char);\n  }\n  return str;\n};\n\nISOBox.prototype._readData = function(size) {\n  var length = (size > 0) ? size : (this._raw.byteLength - (this._cursor.offset - this._offset));\n  if (length > 0) {\n    var data = new Uint8Array(this._raw.buffer, this._cursor.offset, length);\n\n    this._cursor.offset += length;\n    return data;\n  }\n  else {\n    return null;\n  }\n};\n\nISOBox.prototype._readUTF8String = function() {\n  var length = this._raw.byteLength - (this._cursor.offset - this._offset);\n  var data = null;\n  if (length > 0) {\n    data = new DataView(this._raw.buffer, this._cursor.offset, length);\n    this._cursor.offset += length;\n  }\n \n  return data ? ISOBoxer.Utils.dataViewToString(data) : data;\n};\n\nISOBox.prototype._parseBox = function() {\n  this._parsing = true;\n  this._cursor.offset = this._offset;\n\n  // return immediately if there are not enough bytes to read the header\n  if (this._offset + 8 > this._raw.buffer.byteLength) {\n    this._root._incomplete = true;\n    return;\n  }\n\n  this._procField('size', 'uint', 32);\n  this._procField('type', 'string', 4);\n\n  if (this.size === 1)      { this._procField('largesize', 'uint', 64); }\n  if (this.type === 'uuid') { this._procFieldArray('usertype', 16, 'uint', 8); }\n\n  switch(this.size) {\n  case 0:\n    this._raw = new DataView(this._raw.buffer, this._offset, (this._raw.byteLength - this._cursor.offset + 8));\n    break;\n  case 1:\n    if (this._offset + this.size > this._raw.buffer.byteLength) {\n      this._incomplete = true;\n      this._root._incomplete = true;\n    } else {\n      this._raw = new DataView(this._raw.buffer, this._offset, this.largesize);\n    }\n    break;\n  default:\n    if (this._offset + this.size > this._raw.buffer.byteLength) {\n      this._incomplete = true;\n      this._root._incomplete = true;\n    } else {\n      this._raw = new DataView(this._raw.buffer, this._offset, this.size);\n    }\n  }\n\n  // additional parsing\n  if (!this._incomplete) {\n    if (this._boxProcessors[this.type]) {\n      this._boxProcessors[this.type].call(this);\n    }\n    if (this._boxContainers.indexOf(this.type) !== -1) {\n      this._parseContainerBox();\n    } else{\n      // Unknown box => read and store box content\n      this._data = this._readData();\n    }\n  }\n};\n\nISOBox.prototype._parseFullBox = function() {\n  this.version = this._readUint(8);\n  this.flags = this._readUint(24);\n};\n\nISOBox.prototype._parseContainerBox = function() {\n  this.boxes = [];\n  while (this._cursor.offset - this._raw.byteOffset < this._raw.byteLength) {\n    this.boxes.push(ISOBox.parse(this));\n  }\n};\n\n///////////////////////////////////////////////////////////////////////////////////////////////////\n// Write functions\n\nISOBox.prototype.append = function(box, pos) {\n  ISOBoxer.Utils.appendBox(this, box, pos);\n};\n\nISOBox.prototype.getLength = function() {\n  this._parsing = false;\n  this._rawo = null;\n\n  this.size = 0;\n  this._procField('size', 'uint', 32);\n  this._procField('type', 'string', 4);\n\n  if (this.size === 1)      { this._procField('largesize', 'uint', 64); }\n  if (this.type === 'uuid') { this._procFieldArray('usertype', 16, 'uint', 8); }\n\n  if (this._boxProcessors[this.type]) {\n    this._boxProcessors[this.type].call(this);\n  }\n\n  if (this._boxContainers.indexOf(this.type) !== -1) {\n    for (var i = 0; i < this.boxes.length; i++) {\n      this.size += this.boxes[i].getLength();\n    }\n  } \n\n  if (this._data) {\n    this._writeData(this._data);\n  }\n\n  return this.size;\n};\n\nISOBox.prototype.write = function() {\n  this._parsing = false;\n  this._cursor.offset = this._parent._cursor.offset;\n\n  switch(this.size) {\n  case 0:\n    this._rawo = new DataView(this._parent._rawo.buffer, this._cursor.offset, (this.parent._rawo.byteLength - this._cursor.offset));\n    break;\n  case 1:\n      this._rawo = new DataView(this._parent._rawo.buffer, this._cursor.offset, this.largesize);\n    break;\n  default:\n      this._rawo = new DataView(this._parent._rawo.buffer, this._cursor.offset, this.size);\n  }\n\n  this._procField('size', 'uint', 32);\n  this._procField('type', 'string', 4);\n\n  if (this.size === 1)      { this._procField('largesize', 'uint', 64); }\n  if (this.type === 'uuid') { this._procFieldArray('usertype', 16, 'uint', 8); }\n\n  if (this._boxProcessors[this.type]) {\n    this._boxProcessors[this.type].call(this);\n  }\n\n  if (this._boxContainers.indexOf(this.type) !== -1) {\n    for (var i = 0; i < this.boxes.length; i++) {\n      this.boxes[i].write();\n    }\n  } \n\n  if (this._data) {\n    this._writeData(this._data);\n  }\n\n  this._parent._cursor.offset += this.size;\n\n  return this.size;\n};\n\nISOBox.prototype._writeInt = function(size, value) {\n  if (this._rawo) {\n    var offset = this._cursor.offset - this._rawo.byteOffset;\n    switch(size) {\n    case 8:\n      this._rawo.setInt8(offset, value);\n      break;\n    case 16:\n      this._rawo.setInt16(offset, value);\n      break;\n    case 32:\n      this._rawo.setInt32(offset, value);\n      break;\n    case 64:\n      // Warning: JavaScript cannot handle 64-bit integers natively.\n      // This will give unexpected results for integers >= 2^53\n      var s1 = Math.floor(value / Math.pow(2,32));\n      var s2 = value - (s1 * Math.pow(2,32));\n      this._rawo.setUint32(offset, s1);\n      this._rawo.setUint32(offset + 4, s2);\n      break;\n    }\n    this._cursor.offset += (size >> 3);\n  } else {\n    this.size += (size >> 3);\n  }\n};\n\nISOBox.prototype._writeUint = function(size, value) {\n\n  if (this._rawo) {\n    var offset = this._cursor.offset - this._rawo.byteOffset,\n        s1, s2;\n    switch(size) {\n    case 8:\n      this._rawo.setUint8(offset, value);\n      break;\n    case 16:\n      this._rawo.setUint16(offset, value);\n      break;\n    case 24:\n      s1 = (value & 0xFFFF00) >> 8;\n      s2 = (value & 0x0000FF);\n      this._rawo.setUint16(offset, s1);\n      this._rawo.setUint8(offset + 2, s2);\n      break;\n    case 32:\n      this._rawo.setUint32(offset, value);\n      break;\n    case 64:\n      // Warning: JavaScript cannot handle 64-bit integers natively.\n      // This will give unexpected results for integers >= 2^53\n      s1 = Math.floor(value / Math.pow(2,32));\n      s2 = value - (s1 * Math.pow(2,32));\n      this._rawo.setUint32(offset, s1);\n      this._rawo.setUint32(offset + 4, s2);\n      break;\n    }\n    this._cursor.offset += (size >> 3);\n  } else {\n    this.size += (size >> 3);\n  }\n};\n\nISOBox.prototype._writeString = function(size, str) {\n  for (var c = 0; c < size; c++) {\n    this._writeUint(8, str.charCodeAt(c));\n  }\n};\n\nISOBox.prototype._writeTerminatedString = function(str) {\n  if (str.length === 0) {\n    return;\n  }\n  for (var c = 0; c < str.length; c++) {\n    this._writeUint(8, str.charCodeAt(c));\n  }\n  this._writeUint(8, 0);\n};\n\nISOBox.prototype._writeTemplate = function(size, value) {\n  var pre = Math.floor(value);\n  var post = (value - pre) * Math.pow(2, size / 2);\n  this._writeUint(size / 2, pre);\n  this._writeUint(size / 2, post);\n};\n\nISOBox.prototype._writeData = function(data) {\n  var i;\n  //data to copy\n  if (data) {\n    if (this._rawo) {\n      //Array and Uint8Array has also to be managed\n      if (data instanceof Array) {\n        var offset = this._cursor.offset - this._rawo.byteOffset;\n        for (var i = 0; i < data.length; i++) {\n          this._rawo.setInt8(offset + i, data[i]);\n        }\n        this._cursor.offset += data.length;\n      } \n\n      if (data instanceof Uint8Array) {\n        this._root.bytes.set(data, this._cursor.offset);\n        this._cursor.offset += data.length;\n      }\n\n    } else {\n      //nothing to copy only size to compute\n      this.size += data.length;\n    }\n  }\n};\n\nISOBox.prototype._writeUTF8String = function(string) {\n  var u = ISOBoxer.Utils.utf8ToByteArray(string);\n  if (this._rawo) {\n    var dataView = new DataView(this._rawo.buffer, this._cursor.offset, u.length);\n    for (var i = 0; i < u.length; i++) {\n      dataView.setUint8(i, u[i]);\n    }\n  } else {\n    this.size += u.length;\n  }\n};\n\nISOBox.prototype._writeField = function(type, size, value) {\n  switch (type) {\n  case 'uint':\n    this._writeUint(size, value);\n    break;\n  case 'int':\n    this._writeInt(size, value);\n    break;\n  case 'template':\n    this._writeTemplate(size, value);\n    break;\n  case 'string':\n      if (size == -1) {\n        this._writeTerminatedString(value);\n      } else {\n        this._writeString(size, value);\n      }\n      break;\n  case 'data':\n    this._writeData(value);\n    break;\n  case 'utf8':\n    this._writeUTF8String(value);\n    break;\n  default:\n    break;\n  }\n};\n\n// ISO/IEC 14496-15:2014 - avc1 box\nISOBox.prototype._boxProcessors['avc1'] = ISOBox.prototype._boxProcessors['encv'] = function() {\n  // SampleEntry fields\n  this._procFieldArray('reserved1', 6,    'uint', 8);\n  this._procField('data_reference_index', 'uint', 16);\n  // VisualSampleEntry fields\n  this._procField('pre_defined1',         'uint',     16);\n  this._procField('reserved2',            'uint',     16);\n  this._procFieldArray('pre_defined2', 3, 'uint',     32);\n  this._procField('width',                'uint',     16);\n  this._procField('height',               'uint',     16);\n  this._procField('horizresolution',      'template', 32);\n  this._procField('vertresolution',       'template', 32);\n  this._procField('reserved3',            'uint',     32);\n  this._procField('frame_count',          'uint',     16);\n  this._procFieldArray('compressorname', 32,'uint',    8);\n  this._procField('depth',                'uint',     16);\n  this._procField('pre_defined3',         'int',      16);\n  // AVCSampleEntry fields\n  this._procField('config', 'data', -1);\n};\n\n// ISO/IEC 14496-12:2012 - 8.7.2 Data Reference Box\nISOBox.prototype._boxProcessors['dref'] = function() {\n  this._procFullBox();\n  this._procField('entry_count', 'uint', 32);\n  this._procSubBoxes('entries', this.entry_count);\n};\n\n// ISO/IEC 14496-12:2012 - 8.6.6 Edit List Box\nISOBox.prototype._boxProcessors['elst'] = function() {\n  this._procFullBox();\n  this._procField('entry_count', 'uint', 32);\n  this._procEntries('entries', this.entry_count, function(entry) {\n    this._procEntryField(entry, 'segment_duration',     'uint', (this.version === 1) ? 64 : 32);\n    this._procEntryField(entry, 'media_time',           'int',  (this.version === 1) ? 64 : 32);\n    this._procEntryField(entry, 'media_rate_integer',   'int',  16);\n    this._procEntryField(entry, 'media_rate_fraction',  'int',  16);\n  });\n};\n\n// ISO/IEC 23009-1:2014 - 5.10.3.3 Event Message Box\nISOBox.prototype._boxProcessors['emsg'] = function() {\n  this._procFullBox();\n  if (this.version == 1) {\n    this._procField('timescale',                'uint',   32);\n    this._procField('presentation_time',        'uint',   64);\n    this._procField('event_duration',           'uint',   32);\n    this._procField('id',                       'uint',   32);\n    this._procField('scheme_id_uri',            'string', -1);\n    this._procField('value',                    'string', -1);\n  } else {\n    this._procField('scheme_id_uri',            'string', -1);\n    this._procField('value',                    'string', -1);\n    this._procField('timescale',                'uint',   32);\n    this._procField('presentation_time_delta',  'uint',   32);\n    this._procField('event_duration',           'uint',   32);\n    this._procField('id',                       'uint',   32);\n  }\n  this._procField('message_data',             'data',   -1);\n};\n// ISO/IEC 14496-12:2012 - 8.1.2 Free Space Box\nISOBox.prototype._boxProcessors['free'] = ISOBox.prototype._boxProcessors['skip'] = function() {\n  this._procField('data', 'data', -1);\n};\n\n// ISO/IEC 14496-12:2012 - 8.12.2 Original Format Box\nISOBox.prototype._boxProcessors['frma'] = function() {\n  this._procField('data_format', 'uint', 32);\n};\n// ISO/IEC 14496-12:2012 - 4.3 File Type Box / 8.16.2 Segment Type Box\nISOBox.prototype._boxProcessors['ftyp'] =\nISOBox.prototype._boxProcessors['styp'] = function() {\n  this._procField('major_brand', 'string', 4);\n  this._procField('minor_version', 'uint', 32);\n  var nbCompatibleBrands = -1;\n  if (this._parsing) {\n    nbCompatibleBrands = (this._raw.byteLength - (this._cursor.offset - this._raw.byteOffset)) / 4;\n  }\n  this._procFieldArray('compatible_brands', nbCompatibleBrands, 'string', 4);\n};\n\n// ISO/IEC 14496-12:2012 - 8.4.3 Handler Reference Box\nISOBox.prototype._boxProcessors['hdlr'] = function() {\n  this._procFullBox();\n  this._procField('pre_defined',      'uint',   32);\n  this._procField('handler_type',     'string', 4);\n  this._procFieldArray('reserved', 3, 'uint', 32);\n  this._procField('name',             'string', -1);\n};\n\n// ISO/IEC 14496-12:2012 - 8.1.1 Media Data Box\nISOBox.prototype._boxProcessors['mdat'] = function() {\n  this._procField('data', 'data', -1);\n};\n\n// ISO/IEC 14496-12:2012 - 8.4.2 Media Header Box\nISOBox.prototype._boxProcessors['mdhd'] = function() {\n  this._procFullBox();\n  this._procField('creation_time',      'uint', (this.version == 1) ? 64 : 32);\n  this._procField('modification_time',  'uint', (this.version == 1) ? 64 : 32);\n  this._procField('timescale',          'uint', 32);\n  this._procField('duration',           'uint', (this.version == 1) ? 64 : 32);\n  if (!this._parsing && typeof this.language === 'string') {\n    // In case of writing and language has been set as a string, then convert it into char codes array\n    this.language = ((this.language.charCodeAt(0) - 0x60) << 10) |\n                    ((this.language.charCodeAt(1) - 0x60) << 5) |\n                    ((this.language.charCodeAt(2) - 0x60));\n  }\n  this._procField('language',           'uint', 16);\n  if (this._parsing) {\n    this.language = String.fromCharCode(((this.language >> 10) & 0x1F) + 0x60,\n                                        ((this.language >> 5) & 0x1F) + 0x60,\n                                        (this.language & 0x1F) + 0x60);\n  }\n  this._procField('pre_defined',        'uint', 16);\n};\n\n// ISO/IEC 14496-12:2012 - 8.8.2 Movie Extends Header Box\nISOBox.prototype._boxProcessors['mehd'] = function() {\n  this._procFullBox();\n  this._procField('fragment_duration', 'uint', (this.version == 1) ? 64 : 32);\n};\n\n// ISO/IEC 14496-12:2012 - 8.8.5 Movie Fragment Header Box\nISOBox.prototype._boxProcessors['mfhd'] = function() {\n  this._procFullBox();\n  this._procField('sequence_number', 'uint', 32);\n};\n\n// ISO/IEC 14496-12:2012 - 8.8.11 Movie Fragment Random Access Box\nISOBox.prototype._boxProcessors['mfro'] = function() {\n  this._procFullBox();\n  this._procField('mfra_size', 'uint', 32); // Called mfra_size to distinguish from the normal \"size\" attribute of a box\n};\n\n\n// ISO/IEC 14496-12:2012 - 8.5.2.2 mp4a box (use AudioSampleEntry definition and naming)\nISOBox.prototype._boxProcessors['mp4a'] = ISOBox.prototype._boxProcessors['enca'] = function() {\n  // SampleEntry fields\n  this._procFieldArray('reserved1', 6,    'uint', 8);\n  this._procField('data_reference_index', 'uint', 16);\n  // AudioSampleEntry fields\n  this._procFieldArray('reserved2', 2,    'uint', 32);\n  this._procField('channelcount',         'uint', 16);\n  this._procField('samplesize',           'uint', 16);\n  this._procField('pre_defined',          'uint', 16);\n  this._procField('reserved3',            'uint', 16);\n  this._procField('samplerate',           'template', 32);\n  // ESDescriptor fields\n  this._procField('esds',                 'data', -1);\n};\n\n// ISO/IEC 14496-12:2012 - 8.2.2 Movie Header Box\nISOBox.prototype._boxProcessors['mvhd'] = function() {\n  this._procFullBox();\n  this._procField('creation_time',      'uint',     (this.version == 1) ? 64 : 32);\n  this._procField('modification_time',  'uint',     (this.version == 1) ? 64 : 32);\n  this._procField('timescale',          'uint',     32);\n  this._procField('duration',           'uint',     (this.version == 1) ? 64 : 32);\n  this._procField('rate',               'template', 32);\n  this._procField('volume',             'template', 16);\n  this._procField('reserved1',          'uint',  16);\n  this._procFieldArray('reserved2', 2,  'uint',     32);\n  this._procFieldArray('matrix', 9,     'template', 32);\n  this._procFieldArray('pre_defined', 6,'uint',   32);\n  this._procField('next_track_ID',      'uint',     32);\n};\n\n// ISO/IEC 14496-30:2014 - WebVTT Cue Payload Box.\nISOBox.prototype._boxProcessors['payl'] = function() {\n  this._procField('cue_text', 'utf8');\n};\n\n//ISO/IEC 23001-7:2011 - 8.1 Protection System Specific Header Box\nISOBox.prototype._boxProcessors['pssh'] = function() {\n  this._procFullBox();\n  \n  this._procFieldArray('SystemID', 16, 'uint', 8);\n  this._procField('DataSize', 'uint', 32);\n  this._procFieldArray('Data', this.DataSize, 'uint', 8);\n};\n// ISO/IEC 14496-12:2012 - 8.12.5 Scheme Type Box\nISOBox.prototype._boxProcessors['schm'] = function() {\n    this._procFullBox();\n    \n    this._procField('scheme_type', 'uint', 32);\n    this._procField('scheme_version', 'uint', 32);\n\n    if (this.flags & 0x000001) {\n        this._procField('scheme_uri', 'string', -1);\n    }\n};\n// ISO/IEC 14496-12:2012 - 8.6.4.1 sdtp box \nISOBox.prototype._boxProcessors['sdtp'] = function() {\n  this._procFullBox();\n\n  var sample_count = -1;\n  if (this._parsing) {\n    sample_count = (this._raw.byteLength - (this._cursor.offset - this._raw.byteOffset));\n  }\n\n  this._procFieldArray('sample_dependency_table', sample_count, 'uint', 8);\n};\n\n// ISO/IEC 14496-12:2012 - 8.16.3 Segment Index Box\nISOBox.prototype._boxProcessors['sidx'] = function() {\n  this._procFullBox();\n  this._procField('reference_ID', 'uint', 32);\n  this._procField('timescale', 'uint', 32);\n  this._procField('earliest_presentation_time', 'uint', (this.version == 1) ? 64 : 32);\n  this._procField('first_offset', 'uint', (this.version == 1) ? 64 : 32);\n  this._procField('reserved', 'uint', 16);\n  this._procField('reference_count', 'uint', 16);\n  this._procEntries('references', this.reference_count, function(entry) {\n    if (!this._parsing) {\n      entry.reference  = (entry.reference_type  & 0x00000001) << 31;\n      entry.reference |= (entry.referenced_size & 0x7FFFFFFF);\n      entry.sap  = (entry.starts_with_SAP & 0x00000001) << 31;\n      entry.sap |= (entry.SAP_type        & 0x00000003) << 28;\n      entry.sap |= (entry.SAP_delta_time  & 0x0FFFFFFF);\n    }\n    this._procEntryField(entry, 'reference', 'uint', 32);\n    this._procEntryField(entry, 'subsegment_duration', 'uint', 32);\n    this._procEntryField(entry, 'sap', 'uint', 32);\n    if (this._parsing) {\n      entry.reference_type = (entry.reference >> 31) & 0x00000001;\n      entry.referenced_size = entry.reference & 0x7FFFFFFF;\n      entry.starts_with_SAP  = (entry.sap >> 31) & 0x00000001;\n      entry.SAP_type = (entry.sap >> 28) & 0x00000007;\n      entry.SAP_delta_time = (entry.sap  & 0x0FFFFFFF);\n    }\n  });\n};\n\n// ISO/IEC 14496-12:2012 - 8.4.5.3 Sound Media Header Box\nISOBox.prototype._boxProcessors['smhd'] = function() {\n  this._procFullBox();\n  this._procField('balance',  'uint', 16);\n  this._procField('reserved', 'uint', 16);\n};\n\n// ISO/IEC 14496-12:2012 - 8.16.4 Subsegment Index Box\nISOBox.prototype._boxProcessors['ssix'] = function() {\n  this._procFullBox();\n  this._procField('subsegment_count', 'uint', 32);\n  this._procEntries('subsegments', this.subsegment_count, function(subsegment) {\n    this._procEntryField(subsegment, 'ranges_count', 'uint', 32);\n    this._procSubEntries(subsegment, 'ranges', subsegment.ranges_count, function(range) {\n      this._procEntryField(range, 'level', 'uint', 8);\n      this._procEntryField(range, 'range_size', 'uint', 24);\n    });\n  });\n};\n\n// ISO/IEC 14496-12:2012 - 8.5.2 Sample Description Box\nISOBox.prototype._boxProcessors['stsd'] = function() {\n  this._procFullBox();\n  this._procField('entry_count', 'uint', 32);\n  this._procSubBoxes('entries', this.entry_count);\n};\n\n// ISO/IEC 14496-12:2015 - 8.7.7 Sub-Sample Information Box\nISOBox.prototype._boxProcessors['subs'] = function () {\n  this._procFullBox();\n  this._procField('entry_count', 'uint', 32);\n  this._procEntries('entries', this.entry_count, function(entry) {\n    this._procEntryField(entry, 'sample_delta', 'uint', 32);\n    this._procEntryField(entry, 'subsample_count', 'uint', 16);\n    this._procSubEntries(entry, 'subsamples', entry.subsample_count, function(subsample) {\n      this._procEntryField(subsample, 'subsample_size', 'uint', (this.version === 1) ? 32 : 16);\n      this._procEntryField(subsample, 'subsample_priority', 'uint', 8);\n      this._procEntryField(subsample, 'discardable', 'uint', 8);\n      this._procEntryField(subsample, 'codec_specific_parameters', 'uint', 32);\n    });\n  });\n};\n\n//ISO/IEC 23001-7:2011 - 8.2 Track Encryption Box\nISOBox.prototype._boxProcessors['tenc'] = function() {\n    this._procFullBox();\n\n    this._procField('default_IsEncrypted', 'uint', 24);\n    this._procField('default_IV_size', 'uint', 8);\n    this._procFieldArray('default_KID', 16,    'uint', 8);\n };\n\n// ISO/IEC 14496-12:2012 - 8.8.12 Track Fragmnent Decode Time\nISOBox.prototype._boxProcessors['tfdt'] = function() {\n  this._procFullBox();\n  this._procField('baseMediaDecodeTime', 'uint', (this.version == 1) ? 64 : 32);\n};\n\n// ISO/IEC 14496-12:2012 - 8.8.7 Track Fragment Header Box\nISOBox.prototype._boxProcessors['tfhd'] = function() {\n  this._procFullBox();\n  this._procField('track_ID', 'uint', 32);\n  if (this.flags & 0x01) this._procField('base_data_offset',          'uint', 64);\n  if (this.flags & 0x02) this._procField('sample_description_offset', 'uint', 32);\n  if (this.flags & 0x08) this._procField('default_sample_duration',   'uint', 32);\n  if (this.flags & 0x10) this._procField('default_sample_size',       'uint', 32);\n  if (this.flags & 0x20) this._procField('default_sample_flags',      'uint', 32);\n};\n\n// ISO/IEC 14496-12:2012 - 8.8.10 Track Fragment Random Access Box\nISOBox.prototype._boxProcessors['tfra'] = function() {\n  this._procFullBox();\n  this._procField('track_ID', 'uint', 32);\n  if (!this._parsing) {\n    this.reserved = 0;\n    this.reserved |= (this.length_size_of_traf_num  & 0x00000030) << 4;\n    this.reserved |= (this.length_size_of_trun_num  & 0x0000000C) << 2;\n    this.reserved |= (this.length_size_of_sample_num  & 0x00000003);\n  }\n  this._procField('reserved', 'uint', 32);\n  if (this._parsing) {\n    this.length_size_of_traf_num = (this.reserved & 0x00000030) >> 4;\n    this.length_size_of_trun_num = (this.reserved & 0x0000000C) >> 2;\n    this.length_size_of_sample_num = (this.reserved & 0x00000003);\n  }\n  this._procField('number_of_entry', 'uint', 32);\n  this._procEntries('entries', this.number_of_entry, function(entry) {\n    this._procEntryField(entry, 'time', 'uint', (this.version === 1) ? 64 : 32);\n    this._procEntryField(entry, 'moof_offset', 'uint', (this.version === 1) ? 64 : 32);\n    this._procEntryField(entry, 'traf_number', 'uint', (this.length_size_of_traf_num + 1) * 8);\n    this._procEntryField(entry, 'trun_number', 'uint', (this.length_size_of_trun_num + 1) * 8);\n    this._procEntryField(entry, 'sample_number', 'uint', (this.length_size_of_sample_num + 1) * 8);\n  });\n};\n\n// ISO/IEC 14496-12:2012 - 8.3.2 Track Header Box\nISOBox.prototype._boxProcessors['tkhd'] = function() {\n  this._procFullBox();\n  this._procField('creation_time',      'uint',     (this.version == 1) ? 64 : 32);\n  this._procField('modification_time',  'uint',     (this.version == 1) ? 64 : 32);\n  this._procField('track_ID',           'uint',     32);\n  this._procField('reserved1',          'uint',     32);\n  this._procField('duration',           'uint',     (this.version == 1) ? 64 : 32);\n  this._procFieldArray('reserved2', 2,  'uint',     32);\n  this._procField('layer',              'uint',     16);\n  this._procField('alternate_group',    'uint',     16);\n  this._procField('volume',             'template', 16);\n  this._procField('reserved3',          'uint',     16);\n  this._procFieldArray('matrix', 9,     'template', 32);\n  this._procField('width',              'template', 32);\n  this._procField('height',             'template', 32);\n};\n\n// ISO/IEC 14496-12:2012 - 8.8.3 Track Extends Box\nISOBox.prototype._boxProcessors['trex'] = function() {\n  this._procFullBox();\n  this._procField('track_ID',                         'uint', 32);\n  this._procField('default_sample_description_index', 'uint', 32);\n  this._procField('default_sample_duration',          'uint', 32);\n  this._procField('default_sample_size',              'uint', 32);\n  this._procField('default_sample_flags',             'uint', 32);\n};\n\n// ISO/IEC 14496-12:2012 - 8.8.8 Track Run Box\n// Note: the 'trun' box has a direct relation to the 'tfhd' box for defaults.\n// These defaults are not set explicitly here, but are left to resolve for the user.\nISOBox.prototype._boxProcessors['trun'] = function() {\n  this._procFullBox();\n  this._procField('sample_count', 'uint', 32);\n  if (this.flags & 0x1) this._procField('data_offset', 'int', 32);\n  if (this.flags & 0x4) this._procField('first_sample_flags', 'uint', 32);\n  this._procEntries('samples', this.sample_count, function(sample) {\n    if (this.flags & 0x100) this._procEntryField(sample, 'sample_duration', 'uint', 32);\n    if (this.flags & 0x200) this._procEntryField(sample, 'sample_size', 'uint', 32);\n    if (this.flags & 0x400) this._procEntryField(sample, 'sample_flags', 'uint', 32);\n    if (this.flags & 0x800) this._procEntryField(sample, 'sample_composition_time_offset', (this.version === 1) ? 'int' : 'uint',  32);\n  });\n};\n\n// ISO/IEC 14496-12:2012 - 8.7.2 Data Reference Box\nISOBox.prototype._boxProcessors['url '] = ISOBox.prototype._boxProcessors['urn '] = function() {\n  this._procFullBox();\n  if (this.type === 'urn ') {\n    this._procField('name', 'string', -1);\n  }\n  this._procField('location', 'string', -1);\n};\n\n// ISO/IEC 14496-30:2014 - WebVTT Source Label Box\nISOBox.prototype._boxProcessors['vlab'] = function() {\n  this._procField('source_label', 'utf8');\n};\n\n// ISO/IEC 14496-12:2012 - 8.4.5.2 Video Media Header Box\nISOBox.prototype._boxProcessors['vmhd'] = function() {\n  this._procFullBox();\n  this._procField('graphicsmode', 'uint', 16);\n  this._procFieldArray('opcolor', 3, 'uint', 16);\n};\n\n// ISO/IEC 14496-30:2014 - WebVTT Configuration Box\nISOBox.prototype._boxProcessors['vttC'] = function() {\n  this._procField('config', 'utf8');\n};\n\n// ISO/IEC 14496-30:2014 - WebVTT Empty Sample Box\nISOBox.prototype._boxProcessors['vtte'] = function() {\n  // Nothing should happen here.\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}