{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _FactoryMaker = require('../../core/FactoryMaker');\n\nvar _FactoryMaker2 = _interopRequireDefault(_FactoryMaker);\n\nvar _Debug = require('../../core/Debug');\n\nvar _Debug2 = _interopRequireDefault(_Debug);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n/**\n* The copyright in this software is being made available under the BSD License,\n* included below. This software may be subject to other third party and contributor\n* rights, including patent rights, and no such rights are granted under this license.\n*\n* Copyright (c) 2013, Dash Industry Forum.\n* All rights reserved.\n*\n* Redistribution and use in source and binary forms, with or without modification,\n* are permitted provided that the following conditions are met:\n*  * Redistributions of source code must retain the above copyright notice, this\n*  list of conditions and the following disclaimer.\n*  * Redistributions in binary form must reproduce the above copyright notice,\n*  this list of conditions and the following disclaimer in the documentation and/or\n*  other materials provided with the distribution.\n*  * Neither the name of Dash Industry Forum nor the names of its\n*  contributors may be used to endorse or promote products derived from this software\n*  without specific prior written permission.\n*\n*  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY\n*  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n*  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\n*  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n*  INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT\n*  NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n*  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n*  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n*  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n*  POSSIBILITY OF SUCH DAMAGE.\n*/\n\n\nfunction MediaSourceController() {\n  var instance = void 0,\n      logger = void 0;\n  var context = this.context;\n\n  function setup() {\n    logger = (0, _Debug2.default)(context).getInstance().getLogger(instance);\n  }\n\n  function createMediaSource() {\n    var hasWebKit = ('WebKitMediaSource' in window);\n    var hasMediaSource = ('MediaSource' in window);\n\n    if (hasMediaSource) {\n      return new MediaSource();\n    } else if (hasWebKit) {\n      return new WebKitMediaSource();\n    }\n\n    return null;\n  }\n\n  function attachMediaSource(source, videoModel) {\n    var objectURL = window.URL.createObjectURL(source);\n    videoModel.setSource(objectURL);\n    return objectURL;\n  }\n\n  function detachMediaSource(videoModel) {\n    videoModel.setSource(null);\n  }\n\n  function setDuration(source, value) {\n    if (!source || source.readyState !== 'open') return;\n    if (value === null && isNaN(value)) return;\n    if (source.duration === value) return;\n\n    if (!isBufferUpdating(source)) {\n      logger.info('Set MediaSource duration:' + value);\n      source.duration = value;\n    } else {\n      setTimeout(setDuration.bind(null, source, value), 50);\n    }\n  }\n\n  function setSeekable(source, start, end) {\n    if (source && typeof source.setLiveSeekableRange === 'function' && typeof source.clearLiveSeekableRange === 'function' && source.readyState === 'open' && start >= 0 && start < end) {\n      source.clearLiveSeekableRange();\n      source.setLiveSeekableRange(start, end);\n    }\n  }\n\n  function signalEndOfStream(source) {\n    if (!source || source.readyState !== 'open') {\n      return;\n    }\n\n    var buffers = source.sourceBuffers;\n\n    for (var i = 0; i < buffers.length; i++) {\n      if (buffers[i].updating) {\n        return;\n      }\n\n      if (buffers[i].buffered.length === 0) {\n        return;\n      }\n    }\n\n    logger.info('call to mediaSource endOfStream');\n    source.endOfStream();\n  }\n\n  function isBufferUpdating(source) {\n    var buffers = source.sourceBuffers;\n\n    for (var i = 0; i < buffers.length; i++) {\n      if (buffers[i].updating) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  instance = {\n    createMediaSource: createMediaSource,\n    attachMediaSource: attachMediaSource,\n    detachMediaSource: detachMediaSource,\n    setDuration: setDuration,\n    setSeekable: setSeekable,\n    signalEndOfStream: signalEndOfStream\n  };\n  setup();\n  return instance;\n}\n\nMediaSourceController.__dashjs_factory_name = 'MediaSourceController';\nexports.default = _FactoryMaker2.default.getSingletonFactory(MediaSourceController);","map":{"version":3,"mappings":"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","names":["MediaSourceController","instance","logger","context","setup","getInstance","getLogger","createMediaSource","hasWebKit","window","hasMediaSource","MediaSource","WebKitMediaSource","attachMediaSource","source","videoModel","objectURL","URL","createObjectURL","setSource","detachMediaSource","setDuration","value","readyState","isNaN","duration","isBufferUpdating","info","setTimeout","bind","setSeekable","start","end","setLiveSeekableRange","clearLiveSeekableRange","signalEndOfStream","buffers","sourceBuffers","i","length","updating","buffered","endOfStream","__dashjs_factory_name","FactoryMaker","getSingletonFactory"],"sources":["/home/landsys/react-node-video-streaming/client/node_modules/dashjs/src/streaming/controllers/MediaSourceController.js"],"sourcesContent":["/**\n * The copyright in this software is being made available under the BSD License,\n * included below. This software may be subject to other third party and contributor\n * rights, including patent rights, and no such rights are granted under this license.\n *\n * Copyright (c) 2013, Dash Industry Forum.\n * All rights reserved.\n *\n * Redistribution and use in source and binary forms, with or without modification,\n * are permitted provided that the following conditions are met:\n *  * Redistributions of source code must retain the above copyright notice, this\n *  list of conditions and the following disclaimer.\n *  * Redistributions in binary form must reproduce the above copyright notice,\n *  this list of conditions and the following disclaimer in the documentation and/or\n *  other materials provided with the distribution.\n *  * Neither the name of Dash Industry Forum nor the names of its\n *  contributors may be used to endorse or promote products derived from this software\n *  without specific prior written permission.\n *\n *  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS AS IS AND ANY\n *  EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n *  WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.\n *  IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,\n *  INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT\n *  NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR\n *  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,\n *  WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)\n *  ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE\n *  POSSIBILITY OF SUCH DAMAGE.\n */\nimport FactoryMaker from '../../core/FactoryMaker';\nimport Debug from '../../core/Debug';\n\nfunction MediaSourceController() {\n\n    let instance,\n        logger;\n\n    const context = this.context;\n\n    function setup() {\n        logger = Debug(context).getInstance().getLogger(instance);\n    }\n\n    function createMediaSource() {\n\n        let hasWebKit = ('WebKitMediaSource' in window);\n        let hasMediaSource = ('MediaSource' in window);\n\n        if (hasMediaSource) {\n            return new MediaSource();\n        } else if (hasWebKit) {\n            return new WebKitMediaSource();\n        }\n\n        return null;\n    }\n\n    function attachMediaSource(source, videoModel) {\n\n        let objectURL = window.URL.createObjectURL(source);\n\n        videoModel.setSource(objectURL);\n\n        return objectURL;\n    }\n\n    function detachMediaSource(videoModel) {\n        videoModel.setSource(null);\n    }\n\n    function setDuration(source, value) {\n        if (!source || source.readyState !== 'open') return;\n        if (value === null && isNaN(value)) return;\n        if (source.duration === value) return;\n\n        if (!isBufferUpdating(source)) {\n            logger.info('Set MediaSource duration:' + value);\n            source.duration = value;\n        } else {\n            setTimeout(setDuration.bind(null, source, value), 50);\n        }\n    }\n\n    function setSeekable(source, start, end) {\n        if (source && typeof source.setLiveSeekableRange === 'function' && typeof source.clearLiveSeekableRange === 'function' &&\n                source.readyState === 'open' && start >= 0 && start < end) {\n            source.clearLiveSeekableRange();\n            source.setLiveSeekableRange(start, end);\n        }\n    }\n\n    function signalEndOfStream(source) {\n        if (!source || source.readyState !== 'open') {\n            return;\n        }\n\n        let buffers = source.sourceBuffers;\n\n        for (let i = 0; i < buffers.length; i++) {\n            if (buffers[i].updating) {\n                return;\n            }\n            if (buffers[i].buffered.length === 0) {\n                return;\n            }\n        }\n        logger.info('call to mediaSource endOfStream');\n        source.endOfStream();\n    }\n\n    function isBufferUpdating(source) {\n        let buffers = source.sourceBuffers;\n        for (let i = 0; i < buffers.length; i++) {\n            if (buffers[i].updating) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    instance = {\n        createMediaSource: createMediaSource,\n        attachMediaSource: attachMediaSource,\n        detachMediaSource: detachMediaSource,\n        setDuration: setDuration,\n        setSeekable: setSeekable,\n        signalEndOfStream: signalEndOfStream\n    };\n\n    setup();\n\n    return instance;\n}\n\nMediaSourceController.__dashjs_factory_name = 'MediaSourceController';\nexport default FactoryMaker.getSingletonFactory(MediaSourceController);\n"]},"metadata":{},"sourceType":"script"}